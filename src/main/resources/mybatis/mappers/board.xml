<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">


	
	<select id = "getComment" parameterType ="board" resultType ="reply">
		<![CDATA[
    		SELECT
       			replyno as replyNo
       			,stat
       			,a.memberId as memberId 
        		,memberName as memberName
        		,replycontent as content
        		,replydate as replyDate
       			,REPLYGROUP as replyGroup
        		,deep
   			from board_reply a join member b on a.memberId = b.memberId
    		where boardNo = #{boardNo}
   			order by replygroup , deep , replyNo
		]]>
	</select>
	
	<select id = "getBoardList" parameterType ="board" resultType ="board">
		<![CDATA[
		  	select
       			 boardNo
       			,clubId
       			,memberId
       			,clubName
       			,content
       			,boardDate
            from(
  				select
        			rownum as rw
    			   ,boardNo
   			       ,clubId
    			   ,memberId
   			       ,clubName
     			   ,content
    			   ,boardDate
       	       from(
					select
        				a.boardNo as boardNo
        				,a.clubId as clubId
        				,a.memberId as memberId
     			   		,b.clubname as clubName
     			   		,a.boardContent as content
      			  		,a.boardDate as boardDate
        			from board a join club b on a.clubId = b.clubId
        			where 1 = 1
		]]>
				<if test="memberId !=null">
        			and memberId = #{memberId}
				</if>
				<if test="keyword !=''">
  					and boardContent like '%' || #{keyword} || '%'
				</if>

				<if test="clubId !=-99">
					and a.clubId = #{clubId}
				</if>
		<![CDATA[
			        order by boardNo desc
		                        )
    		           				 )
    		      				where rw between #{startNum} and #{endNum}
		]]>
	</select>
	
		
	<insert id = "insertBoard" parameterType = "board">
		<![CDATA[
			insert into board(
				BOARDNO
				, CLUBID
				, MEMBERID
				,BOARDCONTENT
				, BOARDDATE
				)
            values(
            	seq_boardno.nextval
            	, #{clubId} 
            	, #{memberId}
            	, #{content}
            	, sysdate
            	)
		]]>
	</insert>
		
	
	<select id = "getBoard" parameterType = "board" resultType ="board" >
		<![CDATA[
			select
                boardNo
                ,a.clubId as clubId
                ,b.clubName as clubName
                ,memberId
                ,boardContent as content
                ,boardDate
            from board a join club b on a.clubID = b.clubId
            where boardNo = #{boardNo}
		]]>	
	</select>
	
	<update id = "updateBoard" parameterType = "board">
		<![CDATA[
			update board set
				boardContent = #{content}
			where boardNo = #{boardNo}
		]]>
	</update>
	
	<delete id = "deleteBoard" parameterType = "board">
		<![CDATA[
			delete board 
			where boardNo = #{boardNo}		
		]]>	
	</delete>
</mapper>
