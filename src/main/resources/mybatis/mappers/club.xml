<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="club">


	<select id="getMemClub" parameterType="String" resultType="club">
	 	<![CDATA[
			  	select 
	                a.clubName
	                ,a.clubId
	                from club a join club_member b on a.clubId = b.clubId
	            where b.memberId = #{memberId}	
	 	]]>
	</select>
	<select id="clubSum" parameterType="int" resultType="com.firmeet.vo.ClubVo">
		<![CDATA[
			select clubName, 
				   intro1,
				   img2
			from club
			where clubId = #{clubId}
			]]>
	
	</select>
	
	

	<select id="getClubVo" parameterType="int" resultType="club">
	 	<![CDATA[
			  	select 
	                clubId
	                ,clubName
	                ,cre_date
	                ,max
	                ,preNum
	                ,intro1
					,intro2
					,address1
					,address2
					,img1
					,img2
					,detailT
					,detailL
					,detailP
					,detailE
					,detailW
	                from club
	            where clubId = #{clubId}	
	 	]]>
	</select>

	<insert id="insertClub" parameterType="com.firmeet.vo.ClubVo">
		<selectKey resultType="int" order="BEFORE"
			keyProperty="clubId">
			select seq_clubId.nextval from dual
		</selectKey>
        <![CDATA[
           insert into club(clubId,clubName,cre_date,max,preNum,intro1,intro2,address1,
                        address2,detailT,detailL,detailP,detailE,detailW, img1, img2)
                    values(#{clubId}, #{clubName}, sysdate, #{max}, 1,
                          #{intro1}, #{intro2}, #{address1}, #{address2},
                          #{detailT}, #{detailL}, #{detailP}, #{detailE},#{detailW}, #{img1},#{img2})
       ]]>
	</insert>
	<insert id="insertImg" parameterType="com.firmeet.vo.ClubVo">
		      <![CDATA[
		           insert into club(img1,img2)
		                    values(#{img1},#{img2})
		       ]]>

	</insert>

	<insert id="insertClubCate"
		parameterType="com.firmeet.vo.CategoryVo">
		<![CDATA[	
			insert into club_category (clubCateNo,clubId,cateNo)
			values(SEQ_CLUB_CATEGORY_NO.nextval,#{clubId},#{cateNo})
		
		 ]]>
	</insert>

	<insert id="insertClubTag" parameterType="com.firmeet.vo.TagVo">
		<![CDATA[	
			insert into club_tag (clubTagNo,clubId,tagNo)
			values(SEQ_CLUB_TAGNO.nextval,#{clubId},#{tagNo})
		
		 ]]>
	</insert>

	<insert id="insertAdmin"
		parameterType="com.firmeet.vo.ClubMemVo">
     	<![CDATA[	
     			insert into club_member (clubMemNo, memberId, clubId, memLevel, joinDate)
     			values(SEQ_CLUB_MEMNO.nextVal, #{memberId}, #{clubId}, 0, sysdate)
      	]]>
	</insert>


	<insert id="insertJoinMem"
		parameterType="com.firmeet.vo.ClubMemVo">
     <![CDATA[	
     			insert into club_member (memberId, memLevel)
     			values( #{memberId},-10)
      	]]>
	</insert>


	<select id="getClubName" parameterType="board"
		resultType="String">
		<![CDATA[
			select 
				clubName 
			from club 
			where clubId = #{clubId}
		]]>
	</select>

	<select id="checkMemLevel" parameterType="map" resultType="com.firmeet.vo.ClubVo">
		<![CDATA[
			select 
	            a.clubId
	            ,a.clubName
	            ,b.memLevel
             from club a join club_member b on a.clubId = b.clubId
             where b.memberId = #{memberId} and a.clubId = #{clubId}
		]]>
	</select>
</mapper>